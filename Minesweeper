<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Minesweeper</title>
<style>
body{font-family:Arial;background:#667eea;height:100vh;margin:0;display:flex;justify-content:center;align-items:flex-start;padding-top:20px}
#board{display:grid;gap:2px;background:#444;padding:4px;border-radius:6px;transform:scale(0.8);transform-origin:top center}
.cell{width:28px;height:28px;background:#bbb;display:flex;justify-content:center;align-items:center;
font-size:14px;border-radius:4px;cursor:pointer}
.cell.revealed{background:#eee}
.cell.mine{background:#e66}
</style>
</head>
<body>
<div id="board"></div>

<script>
const rows=9, cols=9, mines=10;
let first=true;
const board=[];

const el=document.getElementById("board");
el.style.gridTemplateColumns=`repeat(${cols},28px)`;

for(let r=0;r<rows;r++){
  board[r]=[];
  for(let c=0;c<cols;c++){
    const div=document.createElement("div");
    div.className="cell";
    div.dataset.r=r; div.dataset.c=c;
    div.onclick=()=>clickCell(r,c);
    div.oncontextmenu=e=>{e.preventDefault();flag(r,c)};
    el.appendChild(div);
    board[r][c]={mine:false,rev:false,flag:false,adj:0,el:div};
  }
}

function place(fr,fc){
  let m=0;
  while(m<mines){
    let r=Math.floor(Math.random()*rows),
        c=Math.floor(Math.random()*cols);
    if(Math.abs(r-fr)<=1 && Math.abs(c-fc)<=1) continue;
    if(board[r][c].mine) continue;
    board[r][c].mine=true; m++;
  }
  for(let r=0;r<rows;r++)
    for(let c=0;c<cols;c++)
      if(!board[r][c].mine){
        let n=0;
        for(let i=-1;i<=1;i++)
          for(let j=-1;j<=1;j++){
            let nr=r+i,nc=c+j;
            if(nr>=0&&nr<rows&&nc>=0&&nc<cols&&board[nr][nc].mine)n++;
          }
        board[r][c].adj=n;
      }
}

function clickCell(r,c){
  const cell=board[r][c];
  if(cell.flag||cell.rev) return;
  if(first){first=false;place(r,c);}
  if(cell.mine){lose();return;}
  reveal(r,c);
}

function reveal(r,c){
  const cell=board[r][c];
  if(cell.rev||cell.flag) return;
  cell.rev=true;
  cell.el.classList.add("revealed");
  if(cell.adj>0){cell.el.textContent=cell.adj;return;}
  for(let i=-1;i<=1;i++)
    for(let j=-1;j<=1;j++){
      let nr=r+i,nc=c+j;
      if(nr>=0&&nr<rows&&nc>=0&&nc<cols) reveal(nr,nc);
    }
}

function flag(r,c){
  const cell=board[r][c];
  if(cell.rev) return;
  cell.flag=!cell.flag;
  cell.el.textContent=cell.flag?"ðŸš©":"";
}

function lose(){
  for(let r=0;r<rows;r++)
    for(let c=0;c<cols;c++)
      if(board[r][c].mine){
        board[r][c].el.classList.add("revealed","mine");
        board[r][c].el.textContent="ðŸ’£";
      }
  alert("ÐŸÐ¾Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ!");
}
</script>
</body>
</html>
